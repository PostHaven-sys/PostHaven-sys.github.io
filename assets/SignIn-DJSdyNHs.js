import{_ as C,r as n,c as V,w as _,o as j,a as b,b as i,q as m,e as c,C as z,n as f,t as w,h as I,y as D,j as S,k as x,L,i as k,z as M}from"./index-DdxMNwM7.js";import{I as B}from"./Input-D2a1j6ah.js";const O={class:"form_image"},P={class:"form_input"},q={class:"form_input"},J={class:"form_input"},R={class:"form_input"},$=["disabled"],F={key:1,class:"loadBtn",type:"button"},G={__name:"SignIn",setup(H){const h=k("theme"),y=k("urlAdressAuth"),U=M(),r=n(""),l=n(""),o=n(""),p=n([]),t=n({validate:!1,text:"Такой пользователя не существует"}),e=n({validate:!1,text:"Аккаунт с таким email не существует"}),d=n({validate:!1,text:"Пароль должен быть боле 8 символов"}),u=n(!0),T=V(()=>p.value.filter(s=>s.user_name===r.value)),A=V(()=>p.value.filter(s=>s.user_email===l.value)),E=async()=>{try{const s=await S.get(y);p.value=s.data}catch(s){console.log(s)}},N=async()=>{if(u.value=!1,T.value.length===0){t.value.text="Такой пользователя не существует",t.value.validate=!0,u.value=!0;return}else t.value.validate=!1;if(A.value.length===0){e.value.text="Аккаунт с таким email не существует",e.value.validate=!0,u.value=!0;return}else e.value.validate=!1;if(r.value.length<3){t.value.text="Минимум 3 символа в имени !",t.value.validate=!0,u.value=!0;return}if(l.value.length<10){e.value.text="Не менее 11 символов в электронной почты",e.value.validate=!0,u.value=!0;return}else if(l.value.slice(-9)!=="gmail.com"){e.value.text="E-mail должен оканчиваться на gmail.com",e.value.validate=!0,u.value=!0;return}if(t.value.validate===!0||e.value.validate===!0){u.value=!0;return}if(o.value.length<8){d.value.text="Пароль должен быть боле 8 символов",d.value.validate=!0,u.value=!0;return}try{let a=(await S.get(y)).data.filter(g=>g.user_name===r.value&&g.user_email===l.value&&g.password===o.value);if(u.value=!0,a.length!==1){d.value.text="Неверное имя пользователя, email или пароль",d.value.validate=!0;return}const v={name:r.value,email:l.value,password:o.value};localStorage.setItem("UserId",a[0].user_id),localStorage.setItem("AuthData",JSON.stringify(v)),r.value="",l.value="",o.value="",U.push("/posts")}catch(s){console.log(s)}};return _(()=>{r.value.length&&(t.value.validate=!1)}),_(()=>{l.value.length&&(e.value.validate=!1)}),_(()=>{o.value.length&&(d.value.validate=!1)}),j(()=>{E()}),(s,a)=>(x(),b("div",null,[i("form",{onSubmit:a[3]||(a[3]=D(v=>N(),["prevent"])),id:"signIn_form"},[i("div",O,[m(z,{src:c(L)},null,8,["src"])]),i("div",P,[m(B,{type:"text",width:"100%",height:"100%",BgTheme:c(h)?"themeBgwhite":"themeBgblack",placeholder:"Введите имя пользователя",modelValue:r.value,"onUpdate:modelValue":a[0]||(a[0]=v=>r.value=v),name:"username",id:"username"},null,8,["BgTheme","modelValue"]),i("label",{for:"username",class:f({label_validate:t.value.validate})},w(t.value.text),3)]),i("div",q,[m(B,{type:"email",width:"100%",height:"100%",BgTheme:c(h)?"themeBgwhite":"themeBgblack",placeholder:"Введите почту",modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=v=>l.value=v),name:"email",id:"email"},null,8,["BgTheme","modelValue"]),i("label",{for:"email",class:f({label_validate:e.value.validate})},w(e.value.text),3)]),i("div",J,[m(B,{type:"password",width:"100%",height:"100%",BgTheme:c(h)?"themeBgwhite":"themeBgblack",placeholder:"Введите пароль",modelValue:o.value,"onUpdate:modelValue":a[2]||(a[2]=v=>o.value=v),eye:"",name:"password",id:"password"},null,8,["BgTheme","modelValue"]),i("label",{for:"password",class:f({label_validate:d.value.validate})},w(d.value.text),3)]),i("div",R,[u.value?(x(),b("input",{key:0,type:"submit",value:"Войти",disabled:!r.value||!l.value||!o.value||t.value.validate||e.value.validate,class:f({"disabled-input":!r.value||!l.value||!o.value||t.value.validate||e.value.validate})},null,10,$)):I("",!0),u.value?I("",!0):(x(),b("button",F,a[4]||(a[4]=[i("div",{class:"loader"},null,-1)])))])],32)]))}},W=C(G,[["__scopeId","data-v-006913bf"]]);export{W as default};
