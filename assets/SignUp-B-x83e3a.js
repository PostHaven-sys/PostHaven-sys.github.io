import{_ as D,r as t,c as A,w as b,o as P,a as U,b as l,q as h,e as c,C as R,n as p,t as V,y as q,j as E,k as T,i as k,z as J}from"./index-B8F0F9_-.js";import{a as $}from"./add_img-CmauYyjt.js";import{I as B}from"./Input-Br26d_Fi.js";const F={class:"form_image"},G={class:"form_input"},H={class:"form_input"},K={class:"form_input"},L={class:"form_input"},Q={class:"form_input"},W={class:"form_input"},X=["disabled"],Y={key:1,class:"loadBtn",type:"button"},Z={__name:"SignUp",setup(ee){const f=k("theme"),S=k("urlAdressAuth"),M=k("media"),N=J(),d=t(""),n=t(""),i=t(""),o=t(""),m=t(""),g=t(null),x=t([]),r=t({validate:!1,text:"Имя пользователя уже существует"}),u=t({validate:!1,text:"Электронная почта уже зарегистрирована"}),y=t(!1),_=t({validate:!1,text:"Пароль должен быть боле 8 символов"}),w=t({validate:!1,text:"Не менее 11 символов в электронной почты"}),v=t(!0),C=A(()=>x.value.filter(a=>a.user_name===n.value)),O=A(()=>x.value.filter(a=>a.user_email===i.value)),j=async()=>{try{const a=await E.get(S);x.value=a.data}catch(a){console.log(a)}};function I(){let a=Math.floor(1e3+Math.random()*9e3);if(x.value.filter(s=>s.user_id===a).length>0){I();return}g.value=a}const z=async()=>{if(v.value=!1,g.value===null&&I(),d.value.length<20){y.value=!0,v.value=!0;return}if(n.value.length<3){r.value.text="Минимум 3 символа в имени !",r.value.validate=!0,v.value=!0;return}if(i.value.length<10){u.value.text="Не менее 11 символов в электронной почты",u.value.validate=!0,v.value=!0;return}else if(i.value.slice(-9)!=="gmail.com"){u.value.text="E-mail должен оканчиваться на gmail.com",u.value.validate=!0,v.value=!0;return}if(r.value.validate===!0||u.value.validate===!0){v.value=!0;return}if(o.value.length<8){_.value.text="Пароль должен быть боле 8 символов",_.value.validate=!0,v.value=!0;return}if(m.value!==o.value){w.value.text="Пароли не совпадают",w.value.validate=!0,v.value=!0;return}try{const a=await E.post(S,{user_logo:d.value,user_name:n.value,user_email:i.value,password:o.value,user_id:g.value,biography:""}),e={name:n.value,email:i.value,password:o.value};localStorage.setItem("UserId",g.value),localStorage.setItem("AuthData",JSON.stringify(e)),v.value=!0,d.value="",n.value="",i.value="",o.value="",m.value="",g.value=null,N.push("/posts")}catch(a){console.log(a)}};return b(()=>{C.value.length>0?(r.value.text="Имя пользователя уже существует",r.value.validate=!0):r.value.validate=!1}),b(()=>{O.value.length>0?(u.value.text="Электронная почта уже зарегистрирована",u.value.validate=!0):u.value.validate=!1}),b(()=>{d.value.length>20&&(y.value=!1)}),b(()=>{o.value.length&&(_.value.validate=!1)}),b(()=>{m.value.length&&(w.value.validate=!1)}),P(()=>{j(),I()}),(a,e)=>(T(),U("div",null,[l("form",{onSubmit:e[5]||(e[5]=q(s=>z(),["prevent"])),id:"signUp_form"},[l("div",F,[h(R,{src:d.value||c($)},null,8,["src"])]),l("div",G,[h(B,{type:"text",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Введите ссылку аватара",modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),name:"imgurl",id:"imgurl"},null,8,["BgTheme","modelValue"]),l("label",{for:"imgurl",class:p({label_validate:y.value})}," Ссылка должна быть более 20 символов ",2)]),l("div",H,[h(B,{type:"text",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Создайте имя пользователя",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),name:"username",id:"username"},null,8,["BgTheme","modelValue"]),l("label",{for:"username",class:p({label_validate:r.value.validate})},V(r.value.text),3)]),l("div",K,[h(B,{type:"email",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Введите почту",modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s),name:"email",id:"email"},null,8,["BgTheme","modelValue"]),l("label",{for:"email",class:p({label_validate:u.value.validate})},V(u.value.text),3)]),l("div",L,[h(B,{type:"password",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Создайте пароль",modelValue:o.value,"onUpdate:modelValue":e[3]||(e[3]=s=>o.value=s),eye:"",name:"password",id:"password"},null,8,["BgTheme","modelValue"]),l("label",{for:"password",class:p({label_validate:_.value.validate})},V(_.value.text),3)]),l("div",Q,[h(B,{type:"password",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Повторите пароль",modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),eye:"",name:"passwordrepeat",id:"passwordrepeat"},null,8,["BgTheme","modelValue"]),l("label",{for:"passwordrepeat",class:p({label_validate:w.value.validate})},V(w.value.text),3)]),l("div",W,[v.value?(T(),U("input",{key:0,type:"submit",value:"Зарегистрироваться",disabled:!d.value||!n.value||!i.value||!o.value||!m.value||r.value.validate||u.value.validate,class:p({"disabled-input":!d.value||!n.value||!i.value||!o.value||!m.value||r.value.validate||u.value.validate})},null,10,X)):(T(),U("button",Y,[l("div",{class:p(c(M)?"loader_text":"loader")},null,2)]))])],32)]))}},ue=D(Z,[["__scopeId","data-v-9c2161c1"]]);export{ue as default};
