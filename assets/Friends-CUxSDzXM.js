import{_ as F,m as I,k as V,i as h,r as g,w as $,j as n,a as i,b as k,l as A,u as m,q as D,C as x,n as v,t as w,g as B,h as p,o as C,F as U,e as M,d as j}from"./index-BofsLPDd.js";const N={class:"user_profile"},q={class:"user_logo"},E={key:1,class:"loader"},L=["disabled"],S={key:1,class:"loadBtn"},z={__name:"Friend",props:I({friendsData:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(_){const d=V(_,"modelValue"),b=h("theme"),y=h("user_Id"),o=h("urlAdressAuth"),a=g(!0),u=g(!1),t=g([]),f=async s=>{u.value=!0;try{const e=await p.get(`${o}?user_id=${y}`);if(!e.data||!e.data[0]){console.error("Данные пользователя не найдены");return}t.value=e.data[0].users_subsribe;const l=t.value.findIndex(c=>c===s);if(l!==-1){t.value.splice(l,1);try{await p.put(`${o}/${e.data[0].id}`,{users_subsribe:t.value}),t.value=[],a.value=!0}catch(c){console.error("Ошибка при обновлении данных:",c)}}else{t.value.push(s);try{await p.put(`${o}/${e.data[0].id}`,{users_subsribe:t.value}),t.value=[],a.value=!1}catch(c){console.error("Ошибка при обновлении данных:",c)}}d.value=!0}catch(e){console.error("Ошибка при получении данных пользователя:",e)}};return $(()=>{d.value===!1&&(u.value=!1,d.value=null)}),(s,e)=>(n(),i("div",{class:v(["friend_container",m(b)?"themeBgwhite":"themeBgblack"])},[k("div",N,[k("div",q,[A(x,{src:_.friendsData.user_logo||m(D),width:"100%",height:"100%",balance:""},null,8,["src"])]),_.friendsData.user_name?(n(),i("h2",{key:0,class:v(["user_name",m(b)?"input_light":"input_night"])},w(_.friendsData.user_name),3)):(n(),i("div",E))]),u.value?B("",!0):(n(),i("button",{key:0,onClick:e[0]||(e[0]=l=>f(_.friendsData.user_id)),class:v(["friend_btn",{friend_btn_active:!a.value}]),disabled:u.value},w(a.value?"отписатся":"подписаться"),11,L)),u.value?(n(),i("button",S,e[1]||(e[1]=[k("div",{class:"loader"},null,-1)]))):B("",!0)],2))}},O=F(z,[["__scopeId","data-v-d758204f"]]),T={__name:"Friends",setup(_){const d=h("theme"),b=h("user_Id"),y=h("urlAdressAuth"),o=g([]),a=g(null),u=async f=>{try{const s=await p.get(y);if(s.status!==200)return;const e=s.data.find(r=>r.user_id===b);o.value=s.data.filter(r=>e.users_subsribe.includes(r.user_id)),f===1&&(a.value=!1);const l=s.data.map(r=>r.user_id);let c=e.users_subsribe.filter(r=>l.includes(r));if(e.users_subsribe.filter(r=>!l.includes(r)).length===0)return;t(e.id,c)}catch(s){console.log(s)}};async function t(f,s){try{await p.put(`${y}/${f}`,{users_subsribe:s})}catch(e){console.log(e)}}return $(()=>{a.value===!0&&u(1)}),C(()=>{b&&u(0)}),(f,s)=>(n(),i("div",{class:v(["friends-container",m(d)?"themeBgwhite":"themeBgblack"])},[k("div",{class:v(["friends_container",m(d)?"themeBgwhite":"themeBgblack"])},[o.value.length>0?(n(!0),i(U,{key:0},M(o.value,e=>(n(),j(O,{friendsData:e,modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=l=>a.value=l)},null,8,["friendsData","modelValue"]))),256)):(n(),i("h2",{key:1,class:v(["none_friends",m(d)?"input_light":"input_night"])}," У вас нет друзей. ",2))],2)],2))}},J=F(T,[["__scopeId","data-v-1ba24d4d"]]);export{J as default};
