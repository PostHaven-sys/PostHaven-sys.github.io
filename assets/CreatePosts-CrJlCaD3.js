import{r,o as C,a as h,b as a,n as p,u as i,l as _,C as D,s as P,v as U,t as N,g as x,x as j,i as m,h as f,j as y,y as R}from"./index-popTO3JP.js";import{a as z}from"./add_img-CmauYyjt.js";import{I}from"./Input-D1AeLxp9.js";const E={class:"createpost_container"},F={class:"con_img"},G={class:"input-container"},H={class:"input-container"},Y={class:"textarea-container"},q={class:"input-container"},J=["disabled"],K={key:1,class:"loadBtn",type:"button"},X={__name:"CreatePosts",setup(L){const S=R(),d=m("theme"),V=m("urlAdressAuth"),B=m("urlAdressPosts"),b=m("user_Id"),l=r(""),n=r(""),o=r(""),u=r(!0),c=r([]),v=r(null),k=async t=>{try{const e=await f.get(`${V}?user_id=${t}`);c.value=e.data[0]}catch(e){console.log(e)}},T=()=>{const t=new Date;let e=String(t.getDate()).padStart(2,"0"),s=String(t.getMonth()+1).padStart(2,"0"),g=t.getFullYear(),M=String(t.getHours()).padStart(2,"0"),A=String(t.getMinutes()).padStart(2,"0");return`${e}.${s}.${g} ${M}:${A}`},w=async()=>{let t=Math.floor(1e4+Math.random()*9e4);if((await f.get(B)).data.filter(g=>g.image_id===t).length>0){w();return}v.value=t},$=async()=>{u.value=!1;try{await f.post(B,{user_id:c.value.user_id,image:l.value,title:n.value,description:o.value,like:0,date:T(),user_logo:c.value.user_logo,user_name:c.value.user_name,image_id:v.value}),l.value="",n.value="",o.value="",v.value=null,u.value=!0,S.push("/posts")}catch(t){console.log(t),u.value=!0}};return C(()=>{b&&(k(b),w())}),(t,e)=>(y(),h("div",E,[a("div",F,[a("div",{class:p(["div_img",i(d)?"themeBgwhite":"themeBgblack"])},[_(D,{src:l.value||i(z),class:"border-style"},null,8,["src"])],2)]),a("form",{onSubmit:e[3]||(e[3]=j(s=>$(),["prevent"])),class:"add-form"},[a("div",G,[_(I,{type:"text",width:"100%",height:"100%",BgTheme:i(d)?"themeBgwhite":"themeBgblack",placeholder:"Введите ссылку картинки",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s)},null,8,["BgTheme","modelValue"])]),a("div",H,[_(I,{type:"text",width:"100%",height:"100%",BgTheme:i(d)?"themeBgwhite":"themeBgblack",maxleng:40,placeholder:"Введите названия поста",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s)},null,8,["BgTheme","modelValue"])]),a("div",Y,[P(a("textarea",{class:p(i(d)?"themeBgwhite input_light":"themeBgblack input_night"),maxlength:"500",placeholder:"Описания...","onUpdate:modelValue":e[2]||(e[2]=s=>o.value=s)},null,2),[[U,o.value]]),a("b",null,N(o.value.length)+"/500",1)]),a("div",q,[u.value?(y(),h("input",{key:0,type:"submit",value:"Добавить",disabled:!l.value||!n.value||!o.value,class:p({"disabled-input":!l.value||!n.value||!o.value})},null,10,J)):x("",!0),u.value?x("",!0):(y(),h("button",K,e[4]||(e[4]=[a("div",{class:"loader"},null,-1)])))])],32)]))}};export{X as default};
