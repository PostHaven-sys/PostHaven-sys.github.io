import{_ as I,m as V,l as A,i as m,r as g,u as $,w as x,k as n,a as i,b as w,q as D,e as u,s as C,C as U,n as v,t as B,h as F,j as p,o as M,F as j,f as N,d as q}from"./index-B8F0F9_-.js";const E={class:"user_profile"},L={class:"user_logo"},S={key:1,class:"loader"},z=["disabled"],O={key:1,class:"loadBtn"},T={__name:"Friend",props:V({friendsData:{type:Object,required:!0}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(f){const d=A(f,"modelValue"),b=m("theme"),y=m("user_Id"),o=m("urlAdressAuth"),a=g(!0),c=g(!1),t=g([]),{t:k}=$(),h=async s=>{c.value=!0;try{const e=await p.get(`${o}?user_id=${y}`);if(!e.data||!e.data[0]){console.error("Данные пользователя не найдены");return}t.value=e.data[0].users_subsribe;const l=t.value.findIndex(_=>_===s);if(l!==-1){t.value.splice(l,1);try{await p.put(`${o}/${e.data[0].id}`,{users_subsribe:t.value}),t.value=[],a.value=!0}catch(_){console.error("Ошибка при обновлении данных:",_)}}else{t.value.push(s);try{await p.put(`${o}/${e.data[0].id}`,{users_subsribe:t.value}),t.value=[],a.value=!1}catch(_){console.error("Ошибка при обновлении данных:",_)}}d.value=!0}catch(e){console.error("Ошибка при получении данных пользователя:",e)}};return x(()=>{d.value===!1&&(c.value=!1,d.value=null)}),(s,e)=>(n(),i("div",{class:v(["friend_container",u(b)?"themeBgwhite":"themeBgblack"])},[w("div",E,[w("div",L,[D(U,{src:f.friendsData.user_logo||u(C),width:"100%",height:"100%",balance:""},null,8,["src"])]),f.friendsData.user_name?(n(),i("h2",{key:0,class:v(["user_name",u(b)?"input_light":"input_night"])},B(f.friendsData.user_name),3)):(n(),i("div",S))]),c.value?F("",!0):(n(),i("button",{key:0,onClick:e[0]||(e[0]=l=>h(f.friendsData.user_id)),class:v(["friend_btn",{friend_btn_active:!a.value}]),disabled:c.value},B(a.value?u(k)("friend.text1"):u(k)("friend.text2")),11,z)),c.value?(n(),i("button",O,e[1]||(e[1]=[w("div",{class:"loader"},null,-1)]))):F("",!0)],2))}},G=I(T,[["__scopeId","data-v-ad01c896"]]),H={__name:"Friends",setup(f){const d=m("theme"),b=m("user_Id"),y=m("urlAdressAuth"),o=g([]),a=g(null),{t:c}=$(),t=async h=>{try{const s=await p.get(y);if(s.status!==200)return;const e=s.data.find(r=>r.user_id===b);o.value=s.data.filter(r=>e.users_subsribe.includes(r.user_id)),h===1&&(a.value=!1);const l=s.data.map(r=>r.user_id);let _=e.users_subsribe.filter(r=>l.includes(r));if(e.users_subsribe.filter(r=>!l.includes(r)).length===0)return;k(e.id,_)}catch(s){console.log(s)}};async function k(h,s){try{await p.put(`${y}/${h}`,{users_subsribe:s})}catch(e){console.log(e)}}return x(()=>{a.value===!0&&t(1)}),M(()=>{b&&t(0)}),(h,s)=>(n(),i("div",{class:v(["friends-container",u(d)?"themeBgwhite":"themeBgblack"])},[w("div",{class:v(["friends_container",u(d)?"themeBgwhite":"themeBgblack"])},[o.value.length>0?(n(!0),i(j,{key:0},N(o.value,e=>(n(),q(G,{friendsData:e,modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=l=>a.value=l)},null,8,["friendsData","modelValue"]))),256)):(n(),i("h2",{key:1,class:v(["none_friends",u(d)?"input_light":"input_night"])},B(u(c)("friends")),3))],2)],2))}},P=I(H,[["__scopeId","data-v-dccd0c20"]]);export{P as default};
