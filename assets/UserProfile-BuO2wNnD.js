import{_ as T,r as i,o as j,a as h,b as t,l as N,u as a,C as z,f as M,t as v,g as R,n as r,F as Y,e as q,i as k,z as E,y as G,h as b,j as _,q as H,I as J,d as K}from"./index-BofsLPDd.js";import{S as O}from"./ShowPost-BsfIwjLg.js";import"./Post-DMIPfUvh.js";const Q={class:"my_profile_header"},W={class:"other"},X={class:"name"},Z={key:0,class:"loader_text"},ee={class:"edit_and_settings"},se=["disabled"],te={key:0,class:"loader"},ae={key:1},re={class:"friends_container"},le={class:"friends"},ie={class:"my_profile_footer"},ue={__name:"UserProfile",setup(oe){const l=k("theme"),m=k("urlAdressAuth"),D=k("urlAdressPosts"),w=k("user_Id"),A=E(),B=G(),V=i(0),$=i(0),x=i(0),C=i(!1),u=i([]),P=i(""),y=i(!1),o=i(!1),c=i([]),p=i([]),S=async s=>{try{const[e,n]=await Promise.all([b.get(m),b.get(D)]);if(e.status!==200)return;let d=e.data.find(f=>f.user_id==s);if(d===void 0){B.push("/posts");return}c.value=d,$.value=d.users_subsribe.length;const g=n.data.filter(f=>f.user_id===d.user_id);if(g.length==0){C.value=!0;return}else p.value=g,F();U(e.data,d.user_id),I()}catch(e){console.log(e)}},I=async()=>{o.value=!0;try{const s=await b.get(`${m}?user_id=${w}`);P.value=s.data[0].id,u.value=s.data[0].users_subsribe,s.status===200&&(y.value=s.data[0].users_subsribe.includes(c.value.user_id)),o.value=!1}catch(s){console.log(s),o.value=!1}},U=(s,e)=>{const n=s.filter(d=>{var g;return(g=d.users_subsribe)==null?void 0:g.some(f=>f===e)});if(n.length==0){x.value=0;return}x.value=n.length},F=()=>{for(let s=0;s<p.value.length;s++)V.value+=p.value[s].like},L=async()=>{o.value=!0;const s=u.value.findIndex(e=>e===c.value.user_id);if(y.value==!0){u.value.splice(s,1);try{(await b.put(`${m}/${P.value}`,{users_subsribe:u.value})).status===200&&(I(),u.value=[])}catch(e){console.log(e),o.value=!1}}else{u.value.push(c.value.user_id);try{(await b.put(`${m}/${P.value}`,{users_subsribe:u.value})).status===200&&(I(),u.value=[])}catch(e){console.log(e),o.value=!0}}};return j(()=>{if(w){if(A.params.id==w){B.push("/myProfile");return}S(A.params.id)}}),(s,e)=>(_(),h("div",{class:r(["my_profile_conatiner",a(l)?"themeBgwhite":"themeBgblack"])},[t("div",Q,[N(z,{src:c.value.user_logo||a(H),preview:"",width:"220px",height:"220px",balance:"",style:{overflow:"hidden","border-radius":"50%"}},null,8,["src"]),t("div",W,[t("h2",X,[M(v(c.value.user_name)+" ",1),c.value.user_name?R("",!0):(_(),h("div",Z))]),t("div",ee,[t("button",{onClick:e[0]||(e[0]=n=>L()),disabled:o.value,class:r({"btn-sub_active":y.value})},[o.value==!0?(_(),h("div",te)):(_(),h("span",ae,v(y.value?"отписатся":"подписаться"),1))],10,se),e[1]||(e[1]=t("button",null,"общаться",-1))]),t("div",re,[t("div",le,[t("h3",{class:r(a(l)?"input_light":"input_night")},v(p.value.length||0)+" постов ",3),t("h3",{class:r(a(l)?"input_light":"input_night")},v(V.value||0)+" лайков ",3),t("h3",{class:r(a(l)?"input_light":"input_night")},v($.value||0)+" друзей ",3)]),t("h3",{class:r(a(l)?"input_light":"input_night")},v(x.value)+" человек добавили в друзья ",3)]),t("p",{class:r(["biographies",a(l)?"input_light":"input_night"])}," Нет биографии ",2)])]),t("div",ie,[t("div",{class:r(["liked-text",a(l)?"borderLight":"borderNight"])},[t("h2",{class:r(a(l)?"input_light":"input_night")},"Посты",2),N(a(J),{icon:"bi:images",width:"35",height:"35",class:r(a(l)?"input_light":"input_night"),style:{transition:".3s"}},null,8,["class"])],2),t("div",{class:r(["liked",a(l)?"themeBgwhite":"themeBgblack"])},[C.value===!0?(_(),h("h2",{key:0,class:r(a(l)?"input_light":"input_night")}," У этого пользователя нет постов. ",2)):(_(!0),h(Y,{key:1},q(p.value,n=>(_(),K(O,{key:n.id,likedId:n.id,userProf:!0},null,8,["likedId"]))),128))],2)])],2))}},_e=T(ue,[["__scopeId","data-v-1b180bfd"]]);export{_e as default};
