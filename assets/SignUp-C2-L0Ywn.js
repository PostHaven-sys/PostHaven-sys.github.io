import{_ as P,r as t,c as k,w as b,o as R,a as U,b as l,l as p,u as c,C as z,n as h,t as x,g as A,x as J,h as E,j as T,i as N,y as $}from"./index-popTO3JP.js";import{a as q}from"./add_img-CmauYyjt.js";import{I as B}from"./Input-D1AeLxp9.js";const F={class:"form_image"},G={class:"form_input"},H={class:"form_input"},K={class:"form_input"},L={class:"form_input"},Q={class:"form_input"},W={class:"form_input"},X=["disabled"],Y={key:1,class:"loadBtn",type:"button"},Z={__name:"SignUp",setup(ee){const f=N("theme"),S=N("urlAdressAuth"),C=$(),n=t(""),d=t(""),o=t(""),i=t(""),m=t(""),g=t(null),V=t([]),v=t({validate:!1,text:"Имя пользователя уже существует"}),u=t({validate:!1,text:"Электронная почта уже зарегистрирована"}),y=t(!1),_=t({validate:!1,text:"Пароль должен быть боле 8 символов"}),w=t({validate:!1,text:"Не менее 11 символов в электронной почты"}),r=t(!0),M=k(()=>V.value.filter(a=>a.user_name===d.value)),O=k(()=>V.value.filter(a=>a.user_email===o.value)),j=async()=>{try{const a=await E.get(S);V.value=a.data}catch(a){console.log(a)}};function I(){let a=Math.floor(1e3+Math.random()*9e3);if(V.value.filter(s=>s.user_id===a).length>0){I();return}g.value=a}const D=async()=>{if(r.value=!1,g.value===null&&I(),n.value.length<20){y.value=!0,r.value=!0;return}if(d.value.length<3){v.value.text="Минимум 3 символа в имени !",v.value.validate=!0,r.value=!0;return}if(o.value.length<10){u.value.text="Не менее 11 символов в электронной почты",u.value.validate=!0,r.value=!0;return}else if(o.value.slice(-9)!=="gmail.com"){u.value.text="E-mail должен оканчиваться на gmail.com",u.value.validate=!0,r.value=!0;return}if(v.value.validate===!0||u.value.validate===!0){r.value=!0;return}if(i.value.length<8){_.value.text="Пароль должен быть боле 8 символов",_.value.validate=!0,r.value=!0;return}if(m.value!==i.value){w.value.text="Пароли не совпадают",w.value.validate=!0,r.value=!0;return}try{const a=await E.post(S,{user_logo:n.value,user_name:d.value,user_email:o.value,password:i.value,user_id:g.value,biography:""}),e={name:d.value,email:o.value,password:i.value};localStorage.setItem("UserId",g.value),localStorage.setItem("AuthData",JSON.stringify(e)),r.value=!0,n.value="",d.value="",o.value="",i.value="",m.value="",g.value=null,C.push("/posts")}catch(a){console.log(a)}};return b(()=>{M.value.length>0?(v.value.text="Имя пользователя уже существует",v.value.validate=!0):v.value.validate=!1}),b(()=>{O.value.length>0?(u.value.text="Электронная почта уже зарегистрирована",u.value.validate=!0):u.value.validate=!1}),b(()=>{n.value.length>20&&(y.value=!1)}),b(()=>{i.value.length&&(_.value.validate=!1)}),b(()=>{m.value.length&&(w.value.validate=!1)}),R(()=>{j(),I()}),(a,e)=>(T(),U("div",null,[l("form",{onSubmit:e[5]||(e[5]=J(s=>D(),["prevent"])),id:"singUp_form"},[l("div",F,[p(z,{src:n.value||c(q)},null,8,["src"])]),l("div",G,[p(B,{type:"text",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Введите ссылку аватара",modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),name:"imgurl",id:"imgurl"},null,8,["BgTheme","modelValue"]),l("label",{for:"imgurl",class:h({label_validate:y.value})}," Ссылка должна быть более 20 символов ",2)]),l("div",H,[p(B,{type:"text",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Создайте имя пользователя",modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=s=>d.value=s),name:"username",id:"username"},null,8,["BgTheme","modelValue"]),l("label",{for:"username",class:h({label_validate:v.value.validate})},x(v.value.text),3)]),l("div",K,[p(B,{type:"email",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Введите почту",modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=s=>o.value=s),name:"email",id:"email"},null,8,["BgTheme","modelValue"]),l("label",{for:"email",class:h({label_validate:u.value.validate})},x(u.value.text),3)]),l("div",L,[p(B,{type:"password",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Создайте пароль",modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s),eye:"",name:"password",id:"password"},null,8,["BgTheme","modelValue"]),l("label",{for:"password",class:h({label_validate:_.value.validate})},x(_.value.text),3)]),l("div",Q,[p(B,{type:"password",width:"100%",height:"100%",BgTheme:c(f)?"themeBgwhite":"themeBgblack",placeholder:"Повторите пароль",modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=s=>m.value=s),eye:"",name:"passwordrepeat",id:"passwordrepeat"},null,8,["BgTheme","modelValue"]),l("label",{for:"passwordrepeat",class:h({label_validate:w.value.validate})},x(w.value.text),3)]),l("div",W,[r.value?(T(),U("input",{key:0,type:"submit",value:"Зарегистрироваться",disabled:!n.value||!d.value||!o.value||!i.value||!m.value||v.value.validate||u.value.validate,class:h({"disabled-input":!n.value||!d.value||!o.value||!i.value||!m.value||v.value.validate||u.value.validate})},null,10,X)):A("",!0),r.value?A("",!0):(T(),U("button",Y,e[6]||(e[6]=[l("div",{class:"loader"},null,-1)])))])],32)]))}},ue=P(Z,[["__scopeId","data-v-a4411df9"]]);export{ue as default};
