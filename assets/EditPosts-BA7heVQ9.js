import{r,o as M,a as p,b as t,n as d,u as n,l as h,C as P,s as A,v as I,t as N,g as b,x as j,z,h as y,j as _,y as E,i as g}from"./index-BofsLPDd.js";import{a as R}from"./add_img-CmauYyjt.js";import{I as k}from"./Input-CEd2gRZ4.js";const W={class:"con_img"},F={class:"input-container"},G={class:"input-container"},H={class:"textarea-container"},Y={class:"input-container"},q=["disabled"],J={key:1,class:"loadBtn",type:"button"},X={__name:"EditPosts",setup(K){const B=E(),x=z(),i=g("theme"),w=g("adminUser");g("urlAdressAuth");const f=g("urlAdressPosts"),S=g("profileData"),l=r(""),u=r(""),s=r(""),c=r(!0),m=r(!1),v=r([]),V=async a=>{m.value=!0;try{const e=await y.get(`${f}/${a}`);if(w.value===!1&&e.data.user_id!==S.value.user_id){B.push("/posts");return}l.value=e.data.image,u.value=e.data.title,s.value=e.data.description,v.value=e.data,m.value=!1}catch(e){console.log(e),m.value=!1}},$=()=>{const a=new Date;let e=String(a.getDate()).padStart(2,"0"),o=String(a.getMonth()+1).padStart(2,"0"),D=a.getFullYear(),U=String(a.getHours()).padStart(2,"0"),C=String(a.getMinutes()).padStart(2,"0");return`${e}.${o}.${D} ${U}:${C}`},T=async()=>{c.value=!1;try{await y.put(`${f}/${v.value.id}`,{image:l.value,title:u.value,description:s.value,like:v.value.like,date:$(),user_logo:v.value.user_logo,user_name:v.value.user_name}),l.value="",u.value="",s.value="",c.value=!0,B.go(-1)}catch(a){console.log(a),c.value=!0}};return M(()=>{V(x.params.id)}),(a,e)=>(_(),p("div",{class:d(["createpost_container",n(i)?"themeBgWhite":"themeBgBlack"])},[t("div",{class:d(["loading",n(i)?"themeBgWhiteBlur":"themeBgBlackBlur",{loading_active:m.value}])},[t("div",{class:d({loader:m.value})},null,2)],2),t("div",W,[t("div",{class:d(["div_img",n(i)?"themeBgwhite":"themeBgblack"])},[h(P,{src:l.value||n(R),class:"border-style"},null,8,["src"])],2)]),t("form",{onSubmit:e[3]||(e[3]=j(o=>T(),["prevent"])),class:"add-form"},[t("div",F,[h(k,{type:"text",width:"100%",height:"100%",BgTheme:n(i)?"themeBgwhite":"themeBgblack",placeholder:"Введите новую ссылку картинки",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value=o)},null,8,["BgTheme","modelValue"])]),t("div",G,[h(k,{type:"text",width:"100%",height:"100%",BgTheme:n(i)?"themeBgwhite":"themeBgblack",maxleng:40,placeholder:"Введите новое названия поста",modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=o=>u.value=o)},null,8,["BgTheme","modelValue"])]),t("div",H,[A(t("textarea",{class:d(n(i)?"themeBgwhite input_light":"themeBgblack input_night"),maxlength:"500",placeholder:"Описания...","onUpdate:modelValue":e[2]||(e[2]=o=>s.value=o)},null,2),[[I,s.value]]),t("b",null,N(s.value.length)+"/500",1)]),t("div",Y,[c.value?(_(),p("input",{key:0,type:"submit",value:"Подтвердить изменения",disabled:!l.value||!u.value||!s.value,class:d({"disabled-input":!l.value||!u.value||!s.value})},null,10,q)):b("",!0),c.value?b("",!0):(_(),p("button",J,e[4]||(e[4]=[t("div",{class:"loader"},null,-1)])))])],32)],2))}};export{X as default};
